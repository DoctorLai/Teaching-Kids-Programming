1
00:00:00,700 --> 00:00:01,500
哎大家好

2
00:00:01,500 --> 00:00:03,000
今天我们来讲一个EXCEL

3
00:00:03,133 --> 00:00:06,499
EXCEL的一个函数叫做VLOOKUP 啊

4
00:00:06,500 --> 00:00:08,666
VLOOKUP 这个VLOOKUP

5
00:00:08,666 --> 00:00:11,333
是很常见的一个很有用的一个函数啊

6
00:00:11,333 --> 00:00:12,566
v就是这个vertical

7
00:00:12,566 --> 00:00:13,366
垂直

8
00:00:13,933 --> 00:00:15,066
vertical对吧

9
00:00:15,666 --> 00:00:18,899
那这个 vertical lookup 就垂直查找

10
00:00:18,900 --> 00:00:20,333
比如说我现在有个表格啊

11
00:00:20,333 --> 00:00:22,266
那左边这个是水果的名称

12
00:00:22,266 --> 00:00:23,199
第2列不重要

13
00:00:23,200 --> 00:00:25,133
第3列是一个价钱对吧

14
00:00:25,266 --> 00:00:27,099
那比如说我现在有一个地方

15
00:00:27,100 --> 00:00:29,700
就是我就要输入这个水果的名称

16
00:00:30,100 --> 00:00:31,566
对吧比如苹果

17
00:00:31,566 --> 00:00:34,766
然后我希望的是这个price这1列啊

18
00:00:34,766 --> 00:00:37,399
就得到相应对应的3块钱

19
00:00:37,666 --> 00:00:39,133
对啊如果这改成cherry

20
00:00:39,133 --> 00:00:40,899
它就要变成一块钱

21
00:00:40,900 --> 00:00:43,400
它就查找了就是相对的去查找

22
00:00:43,533 --> 00:00:45,099
那我这时候我就可以VLookup

23
00:00:45,366 --> 00:00:47,666
就等于啊那你看啊这个VLookup

24
00:00:47,600 --> 00:00:49,666
VLOOKUP 然后它那个第一个

25
00:00:49,833 --> 00:00:51,000
第一个参数

26
00:00:51,000 --> 00:00:53,100
它第一个参数就是 Lookup 的这个value

27
00:00:53,200 --> 00:00:56,500
那我就是要指定是你这个输入吗

28
00:00:56,500 --> 00:00:58,933
就等于相当于这个输入我就选它对吧

29
00:00:59,500 --> 00:01:01,400
就D11这个

30
00:01:01,733 --> 00:01:02,800
这个 Table Array

31
00:01:02,800 --> 00:01:04,300
第二个参数就是 Table Array

32
00:01:04,300 --> 00:01:06,466
就是它要查到这个表格啊

33
00:01:06,533 --> 00:01:07,733
那表格我就这么选

34
00:01:07,733 --> 00:01:08,666
我就是这样选吗

35
00:01:08,666 --> 00:01:10,600
对啊这查到的表格 简单

36
00:01:10,933 --> 00:01:13,833
那第3个是说你要返回的那个

37
00:01:14,400 --> 00:01:16,666
就是那一列的这个index啊

38
00:01:16,666 --> 00:01:17,733
就是它的索引值

39
00:01:17,733 --> 00:01:19,666
比如说这个是第一列 Fruit 第一列

40
00:01:19,666 --> 00:01:20,466
这个是第2列

41
00:01:20,866 --> 00:01:22,100
这个是第3列对吧

42
00:01:22,100 --> 00:01:23,200
那我要返回第3列

43
00:01:23,200 --> 00:01:25,533
我因为我查找如果对应这个cherry

44
00:01:25,533 --> 00:01:27,200
我要返回它第三列的值嘛 是吧

45
00:01:27,200 --> 00:01:28,900
所以这个就是1-2-3对吧

46
00:01:29,733 --> 00:01:31,200
然后第四个它有两个值

47
00:01:31,200 --> 00:01:32,066
就是一个布尔值

48
00:01:32,066 --> 00:01:33,733
就是 True 和 False

49
00:01:33,866 --> 00:01:34,733
对和不对 (是或非)

50
00:01:34,733 --> 00:01:37,033
True 就是模糊查找

51
00:01:37,266 --> 00:01:39,800
那90%的情况下面你应该

52
00:01:39,800 --> 00:01:41,033
选择不是模糊查找

53
00:01:41,033 --> 00:01:42,833
就是那个精确查找

54
00:01:42,833 --> 00:01:44,500
所以我们要给它一个 False

55
00:01:44,633 --> 00:01:46,333
就是布尔值 这个非的意思啊

56
00:01:46,433 --> 00:01:48,866
输入一下它就3 我们改一下啊就是

57
00:01:49,433 --> 00:01:50,133
比如说 Pear 对吧

58
00:01:50,133 --> 00:01:51,666
它就能变成5对不对

59
00:01:52,033 --> 00:01:55,099
那如果你想的这个值 如果不在这个里面

60
00:01:55,100 --> 00:01:55,900
它会出错啊

61
00:01:55,900 --> 00:01:57,133
我比如说随便输一点

62
00:01:57,166 --> 00:01:58,666
它就会出错对吧

63
00:01:58,733 --> 00:02:01,299
对那刚才那个模糊查找是啥意思呢?

64
00:02:01,300 --> 00:02:03,033
它有可能是在一个期间的啊

65
00:02:03,033 --> 00:02:05,300
就是大概对吧

66
00:02:05,300 --> 00:02:07,133
那这个东西就是可怎么可以理解呢?

67
00:02:07,133 --> 00:02:08,766
就比如说你比如说这个

68
00:02:08,966 --> 00:02:10,733
呃这个学生的成绩哈

69
00:02:10,733 --> 00:02:12,300
如果你按这个排序的话

70
00:02:12,733 --> 00:02:16,300
那我们要我们要看它是哪一个阶段了

71
00:02:16,300 --> 00:02:18,066
比如说是优良中差对不对

72
00:02:18,066 --> 00:02:21,033
那这时候我们就没有办法去

73
00:02:21,300 --> 00:02:23,533
那个精确匹配它哪一个分数

74
00:02:23,533 --> 00:02:25,466
那我们就在一个期间段对吧

75
00:02:25,466 --> 00:02:26,933
这时候就是模糊查找

76
00:02:26,933 --> 00:02:28,799
呃那这里面有一个 VLOOKUP

77
00:02:28,800 --> 00:02:29,566
需要注意的是

78
00:02:29,566 --> 00:02:31,833
它每次这个 VLOOKUP Table

79
00:02:31,833 --> 00:02:32,566
这个表格啊

80
00:02:32,566 --> 00:02:33,200
第二个参数

81
00:02:33,200 --> 00:02:33,933
这个 Table 表格

82
00:02:33,933 --> 00:02:35,999
它永远是拿第一列

83
00:02:36,166 --> 00:02:38,000
去匹配你要的这个 Input

84
00:02:38,033 --> 00:02:40,133
它没法选出其它列

85
00:02:40,133 --> 00:02:42,466
所以你看这个第二个参数A2到C7

86
00:02:42,733 --> 00:02:46,233
它是第一列去匹配你这个D11对吧

87
00:02:46,600 --> 00:02:48,266
这个是它的一个局限啊

88
00:02:48,266 --> 00:02:49,933
这个是一个问题

89
00:02:49,933 --> 00:02:52,400
它就是实际上它是一个线性的查找

90
00:02:52,800 --> 00:02:53,866
对吧 什么是线性查找

91
00:02:53,866 --> 00:02:55,866
它就是从第一个开始往下找对吧

92
00:02:56,400 --> 00:02:58,333
精确找, 找到了我就返回

93
00:02:58,333 --> 00:02:59,733
找到了就返回 对不对

94
00:02:59,866 --> 00:03:01,333
这就是线性查找嘛

95
00:03:01,333 --> 00:03:03,200
我们计算机里面线性查找

96
00:03:03,200 --> 00:03:04,166
从第一个找

97
00:03:04,333 --> 00:03:06,400
第二个找 第3个找 找到第n个

98
00:03:06,400 --> 00:03:07,766
那如果你想想这个列

99
00:03:07,766 --> 00:03:09,333
这个行数很多的话

100
00:03:09,333 --> 00:03:10,466
那它可能会很慢

101
00:03:10,466 --> 00:03:11,366
理论上啊

102
00:03:11,366 --> 00:03:14,066
因为EXCEL它可能最大支持的这个行数

103
00:03:14,166 --> 00:03:15,333
呃呃可能

104
00:03:16,033 --> 00:03:17,633
可能也不知道多少多少个

105
00:03:17,633 --> 00:03:18,466
可能几万吧

106
00:03:18,633 --> 00:03:20,866
这个这一点的数据量应该是可以没

107
00:03:20,866 --> 00:03:21,566
没问题的啊

108
00:03:21,566 --> 00:03:23,600
然后这个 vlookup

109
00:03:23,966 --> 00:03:25,400
这个v是 vertical 吗 对吧

110
00:03:25,400 --> 00:03:26,366
那如果你这个表

111
00:03:26,366 --> 00:03:28,100
有的时候表格它是横过来的

112
00:03:28,100 --> 00:03:29,533
这个表格如果是 Transpose

113
00:03:29,733 --> 00:03:31,866
就是怎么说呢? 就是我就横过来啊

114
00:03:31,866 --> 00:03:33,733
我就不列过来 比如说是这样子的

115
00:03:34,066 --> 00:03:35,300
对横过来是吧

116
00:03:35,533 --> 00:03:38,466
啊加一行, 就是这行也不重要啊

117
00:03:38,866 --> 00:03:41,733
对啊, 那我要满足同样的这个方法

118
00:03:41,733 --> 00:03:44,500
但是查找是横过来这个表格

119
00:03:44,500 --> 00:03:45,566
那我们就可以用另外一个函数

120
00:03:45,566 --> 00:03:46,966
另外一个函数叫做 HLOOKUP

121
00:03:46,966 --> 00:03:48,766
H=Horizontal 水平意思

122
00:03:48,833 --> 00:03:50,566
是吧 比如说我这边来一个

123
00:03:52,233 --> 00:03:53,833
这边来一个price啊

124
00:03:53,833 --> 00:03:55,233
Fruit 我比如说是

125
00:03:55,633 --> 00:03:56,200
cherry好了

126
00:03:56,200 --> 00:03:58,400
它应该给我对应返回的是这个1

127
00:03:58,400 --> 00:03:59,200
是吧

128
00:03:59,766 --> 00:04:00,600
那怎么弄呢

129
00:04:00,600 --> 00:04:04,200
就是HLOOKUP 它实际上是参数是一样啊

130
00:04:04,200 --> 00:04:06,066
第一个就是 Lookup Value

131
00:04:06,133 --> 00:04:08,000
那我 Lookup Value 就是选这个

132
00:04:08,200 --> 00:04:10,633
D11, TABLE value对吧

133
00:04:10,633 --> 00:04:12,833
TABLE value就是我整个表格对吧

134
00:04:12,833 --> 00:04:14,333
整个表格那我就是

135
00:04:14,666 --> 00:04:16,833
这样子这个整个表格对吧

136
00:04:17,266 --> 00:04:19,266
同样它是只匹配第1行对吧

137
00:04:19,266 --> 00:04:21,333
刚才那个 VLOOKUP 是匹配第1列

138
00:04:21,333 --> 00:04:22,566
现在我匹配第1行

139
00:04:22,800 --> 00:04:25,766
那我现在要返回的这个行的这个

140
00:04:25,766 --> 00:04:26,466
索引数

141
00:04:26,466 --> 00:04:28,433
个是第一行第2行第3行

142
00:04:28,533 --> 00:04:30,233
我要返回第3行price对吧

143
00:04:30,233 --> 00:04:31,466
所以我输入一个三

144
00:04:31,633 --> 00:04:34,033
那最后一个也是一个精确的匹配

145
00:04:34,233 --> 00:04:35,933
呃查找还是一个模糊查找

146
00:04:35,933 --> 00:04:38,433
那我就呃90%都应该是FALSE

147
00:04:38,966 --> 00:04:39,833
精确查找

148
00:04:40,200 --> 00:04:41,533
那么它应该是返回一吗

149
00:04:41,533 --> 00:04:43,166
对如果返回一个

150
00:04:43,633 --> 00:04:44,566
给一个这哎

151
00:04:44,566 --> 00:04:46,466
给一个这个 lychee 的话

152
00:04:46,466 --> 00:04:48,033
它应该是给个7对吧

153
00:04:48,033 --> 00:04:50,933
这就是一个呃呃

154
00:04:51,033 --> 00:04:53,066
水平查找这个 HLOOKUP

155
00:04:53,066 --> 00:04:56,066
那VLOOKUP 和 HLOOKUP 它实际上是一样子

156
00:04:56,066 --> 00:04:57,200
是给的数据

157
00:04:57,233 --> 00:04:59,133
它是横的表格还是纵的表格

158
00:04:59,133 --> 00:05:00,866
那它有一个问题哈

159
00:05:00,866 --> 00:05:02,600
就是一个为什么问题就是它

160
00:05:02,966 --> 00:05:07,000
这个匹配的这个表是第1行或第1列

161
00:05:07,000 --> 00:05:08,766
它这是它的一个缺陷啊

162
00:05:08,766 --> 00:05:11,133
对啊然后而且它是一个线性查找

163
00:05:12,000 --> 00:05:14,166
对啊 你没法给它二分搜索

164
00:05:14,166 --> 00:05:16,400
如果你一个数据它是有序的啊

165
00:05:16,400 --> 00:05:17,533
就是比如排好序

166
00:05:17,533 --> 00:05:19,566
我们是可以用二分查找 Binary Search

167
00:05:19,566 --> 00:05:21,166
我们算法课讲过

168
00:05:21,166 --> 00:05:23,400
用二分查找会快很多 对不对

169
00:05:23,533 --> 00:05:24,966
那我们我们来试一下

170
00:05:24,966 --> 00:05:27,466
有一个叫有个方法叫做什么呢

171
00:05:27,466 --> 00:05:28,866
叫做 XLOOKUP

172
00:05:29,633 --> 00:05:32,800
x 你可以想一下吗刚才是横的 HLOOKUP

173
00:05:33,533 --> 00:05:34,333
Vertical Lookup

174
00:05:34,333 --> 00:05:36,366
那我这样加起来就是一个x对吧

175
00:05:36,366 --> 00:05:38,566
就等于 XLOOKUP 啊

176
00:05:38,566 --> 00:05:40,500
这个函数是在最新版本的哎

177
00:05:40,500 --> 00:05:41,466
excel会有啊

178
00:05:41,466 --> 00:05:43,600
Excel 2019 之前可能都没有

179
00:05:43,666 --> 00:05:45,066
那 Lookup Value 这个一样啊

180
00:05:45,066 --> 00:05:47,666
我们先先把这个price写呃

181
00:05:48,200 --> 00:05:50,433
呃这个fruit 写在这里啊

182
00:05:51,300 --> 00:05:52,266
这个price

183
00:05:53,233 --> 00:05:55,766
然后我这个是 Pear 好了

184
00:05:56,366 --> 00:05:58,466
等于XLOOKUP

185
00:05:59,400 --> 00:06:01,266
第一个就是 LOOKUP VALUE 一样的啊

186
00:06:01,266 --> 00:06:02,466
我就要 LOOKUP 查找这个

187
00:06:02,900 --> 00:06:05,500
那 Lookup Array 第二个参数是一个数组

188
00:06:05,500 --> 00:06:07,100
就是我要查找的这个呃

189
00:06:07,100 --> 00:06:10,233
就是这个 Lookup Value 在哪1列里面嘛

190
00:06:10,566 --> 00:06:12,400
你可以是一列或一行嘛

191
00:06:12,400 --> 00:06:14,000
那我这时候应该是在

192
00:06:14,466 --> 00:06:15,433
这里面查找吧

193
00:06:15,433 --> 00:06:17,200
所以我就写第一行了 对吧

194
00:06:17,700 --> 00:06:18,500
然后

195
00:06:18,600 --> 00:06:20,966
下一个是我要返回的是哪一列是吧

196
00:06:20,966 --> 00:06:22,233
我就把它拆分开来嘛

197
00:06:22,233 --> 00:06:23,900
我就要返回这一列对吧

198
00:06:24,966 --> 00:06:25,500
很有意思啊

199
00:06:25,500 --> 00:06:27,100
再下来之后如果我没找到的话

200
00:06:27,100 --> 00:06:29,433
刚才是没找到它会有个错误 是不是

201
00:06:29,600 --> 00:06:32,433
对不对 没找到 要呃返回一个错误

202
00:06:32,433 --> 00:06:34,166
那我现在我就可以直接说没找到

203
00:06:34,166 --> 00:06:35,100
我返回什么呢

204
00:06:35,100 --> 00:06:36,400
Not Found 好吧

205
00:06:36,966 --> 00:06:39,400
然后这个 Match Mode 下一个参数啊

206
00:06:39,700 --> 00:06:41,866
下一个参数就是呃

207
00:06:41,866 --> 00:06:42,466
值得说的是

208
00:06:42,466 --> 00:06:42,833
刚才

209
00:06:42,833 --> 00:06:45,566
前这个函数的前面3个参数是必选的

210
00:06:45,566 --> 00:06:48,166
就是后面3个参数是不用必选的

211
00:06:48,166 --> 00:06:49,366
就是可选啊

212
00:06:49,633 --> 00:06:51,666
就是前面3个参数就是 Lookup Value

213
00:06:51,666 --> 00:06:53,900
我要查找的这个呃值

214
00:06:53,900 --> 00:06:54,633
然后第二个参

215
00:06:54,633 --> 00:06:56,166
数是我要查找的这个数组

216
00:06:56,166 --> 00:06:58,366
第三个是我要返回的数组啊

217
00:06:58,366 --> 00:06:59,966
第四个参数就是我没有找到

218
00:07:00,100 --> 00:07:00,900
它的值是什么

219
00:07:00,900 --> 00:07:03,233
第五个参数就是说如果我的

220
00:07:03,366 --> 00:07:05,100
呃就是我要查找的模式吗

221
00:07:05,100 --> 00:07:07,800
那0默认是0, 0就是完全匹配

222
00:07:08,000 --> 00:07:09,700
-1是那个

223
00:07:10,166 --> 00:07:12,766
完全匹配或者下一个小的值

224
00:07:12,933 --> 00:07:15,733
1是完全匹配或者找下一个大的值

225
00:07:15,733 --> 00:07:18,166
这个一般我们就不用去太深入了解

226
00:07:18,166 --> 00:07:19,600
我们就0就好了

227
00:07:20,833 --> 00:07:23,100
最后一个传说就是就查找模式吗

228
00:07:23,100 --> 00:07:25,833
我们一般默认就是1, 1就是从头

229
00:07:26,233 --> 00:07:28,233
线性搜索到尾对吧

230
00:07:28,633 --> 00:07:32,266
然后-1就是从尾搜索到反过来查找

231
00:07:32,866 --> 00:07:35,633
0就是从头再开始这么找

232
00:07:35,900 --> 00:07:37,600
-1就是这么找对吧

233
00:07:37,600 --> 00:07:40,000
那还有一个2就是二分查找啊

234
00:07:40,000 --> 00:07:41,433
二分查找是这么找

235
00:07:41,900 --> 00:07:44,100
然后是递增的吗

236
00:07:44,100 --> 00:07:44,833
二分查找的话

237
00:07:44,833 --> 00:07:46,600
你需要这个数组是递增的

238
00:07:46,600 --> 00:07:47,400
然后

239
00:07:47,633 --> 00:07:50,866
-2它这是也是2分查找但是反过来找（递减）

240
00:07:51,100 --> 00:07:51,366
对吧

241
00:07:51,366 --> 00:07:53,766
这个就刚才我们讲的就是说前面这个

242
00:07:54,000 --> 00:07:55,100
HLOOKUP VLOOKUP

243
00:07:55,100 --> 00:07:57,366
刚才有个问题就是它是线性查找的

244
00:07:57,366 --> 00:07:58,066
那如果你这个

245
00:07:58,100 --> 00:08:00,033
数据比较多的话又是排好序

246
00:08:00,433 --> 00:08:00,933
就是你的

247
00:08:00,933 --> 00:08:02,933
你要查找的都这个东西是排好序的

248
00:08:02,933 --> 00:08:04,900
那你就可以用二分查找来加快

249
00:08:05,100 --> 00:08:07,566
但是我相信你基本上不用

250
00:08:07,766 --> 00:08:10,666
在EXCEL里面不太可能会处理这么

251
00:08:10,866 --> 00:08:12,133
很多的数据量

252
00:08:12,133 --> 00:08:14,433
所以我们一般也就是从头从

253
00:08:15,066 --> 00:08:16,933
呃那个找到尾，就１就好了

254
00:08:16,933 --> 00:08:18,266
那你看这个就 Pear 就5

255
00:08:18,266 --> 00:08:19,333
那我们再试一下

256
00:08:19,766 --> 00:08:21,300
对吧 这个比如说

257
00:08:22,133 --> 00:08:22,933
orange

258
00:08:23,900 --> 00:08:24,700
它应该是２了

259
00:08:24,700 --> 00:08:27,500
对吧 那这个东西就灵活性很大吗

260
00:08:27,500 --> 00:08:29,966
因为它就把一个表格拆分成

261
00:08:30,366 --> 00:08:31,866
那个你要找的这个数组

262
00:08:31,866 --> 00:08:34,100
跟你要返回的这个匹配

263
00:08:34,100 --> 00:08:36,166
匹配到返回的这个数组对不对

264
00:08:36,300 --> 00:08:37,533
然后它还提供了一个

265
00:08:37,533 --> 00:08:38,766
就是说如果没找到

266
00:08:38,766 --> 00:08:41,500
你要显示默认的这个值是多少

267
00:08:41,500 --> 00:08:44,133
当然还有一些呃额外的选项

268
00:08:44,133 --> 00:08:45,300
比如二分查找这样的

269
00:08:45,300 --> 00:08:46,766
所以这个就是在

270
00:08:47,300 --> 00:08:49,166
这个生活工作中

271
00:08:49,166 --> 00:08:51,100
就是建议能用这个 XLOOKUP 就用

272
00:08:51,366 --> 00:08:53,700
因为它是后面的这个Improved的这个Version

273
00:08:53,700 --> 00:08:54,500
对吧

274
00:08:55,066 --> 00:08:57,500
啊基本上我们讲的就是这个啊

275
00:08:57,666 --> 00:08:58,966
那注意这个表格的话

276
00:08:58,966 --> 00:09:00,666
它有可能你这样选的时候

277
00:09:00,833 --> 00:09:02,366
你比如移动的话

278
00:09:02,366 --> 00:09:04,166
它可能会这个reference会变啊

279
00:09:04,166 --> 00:09:06,566
我们在excel里面其实是可以用这个

280
00:09:06,566 --> 00:09:07,000
Dollar 符号 $

281
00:09:07,133 --> 00:09:08,566
呃加在这个

282
00:09:09,000 --> 00:09:11,400
列前面啊就是比如说A2是这个字

283
00:09:11,466 --> 00:09:13,800
那么它这个是不会再变的对吧

284
00:09:13,800 --> 00:09:15,733
就是绝对的这个

285
00:09:15,866 --> 00:09:17,100
对对对F4啊

286
00:09:17,100 --> 00:09:17,900
很好很好

287
00:09:18,100 --> 00:09:21,066
行那今天我们就讲了这3个函数啊

288
00:09:21,066 --> 00:09:21,800
一个 HLOOKUP

289
00:09:21,800 --> 00:09:22,500
一个 VLOOKUP

290
00:09:22,500 --> 00:09:23,566
还有一个 XLOOKUP

291
00:09:24,100 --> 00:09:25,333
嗯有什么问题吗

292
00:09:25,333 --> 00:09:26,333
没有好

293
00:09:26,333 --> 00:09:27,066
你就这样啊

294
00:09:27,066 --> 00:09:28,066
拜拜拜拜

295
00:09:29,000 --> 00:09:30,366
这就是这一期的内容

296
00:09:30,466 --> 00:09:31,999
如果喜欢我们的视频

297
00:09:32,000 --> 00:09:34,300
求赞！求收藏！求订阅！

298
00:09:34,300 --> 00:09:36,166
我们是 老赖 和 小方

299
00:09:36,300 --> 00:09:38,833
下期见！Bye Bye!

