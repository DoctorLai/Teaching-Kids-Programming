1
00:00:00,266 --> 00:00:02,700
大家好 今天我们继续讲 EXCEL

2
00:00:02,966 --> 00:00:05,233
那上节课我们讲那个VLOOKUP 是吧?

3
00:00:05,233 --> 00:00:07,200
VLOOKUP XLOOKUP HLOOKUP

4
00:00:07,266 --> 00:00:08,000
XLOOKUP

5
00:00:08,066 --> 00:00:10,566
XLOOKUP在*旧*版本里(2019之前)就确实用不了啊

6
00:00:10,566 --> 00:00:12,666
这个VLOOKUP和HLOOKUP

7
00:00:12,666 --> 00:00:13,566
它还有一个问题

8
00:00:13,566 --> 00:00:15,500
就是它只能返回第1列了 是吧

9
00:00:15,633 --> 00:00:17,166
这是第1列或第1行

10
00:00:17,166 --> 00:00:18,833
所以就比较麻烦

11
00:00:18,833 --> 00:00:21,500
那我们今天来讲两个函数, 一个是index

12
00:00:21,566 --> 00:00:22,700
还有一个是match

13
00:00:22,700 --> 00:00:25,633
然后通过这两个函数就可以呃

14
00:00:25,766 --> 00:00:29,300
很灵活的完成这个你要的 LOOKUP

15
00:00:29,300 --> 00:00:30,200
先列一个问题吧

16
00:00:30,200 --> 00:00:32,800
比如说我就这么一个那个2维的表格

17
00:00:32,800 --> 00:00:35,400
那这个名字 这个是

18
00:00:35,600 --> 00:00:37,300
这个是那个月份

19
00:00:37,333 --> 00:00:38,433
那我可能我这边

20
00:00:38,433 --> 00:00:40,000
需要有一个这个功能啊

21
00:00:40,000 --> 00:00:41,700
就是输入你的名字

22
00:00:41,700 --> 00:00:43,100
输入这个月份是吧

23
00:00:43,100 --> 00:00:45,100
比如说输入这个Eric

24
00:00:45,300 --> 00:00:47,066
然后输入这个Mar

25
00:00:47,566 --> 00:00:47,933
对吧

26
00:00:47,933 --> 00:00:50,900
那你这个这个value你应该是去查表吗

27
00:00:50,900 --> 00:00:53,066
是不是这个Eric在这里是吧

28
00:00:53,066 --> 00:00:55,433
然后 Mar 是这里 就是这个横的

29
00:00:55,500 --> 00:00:57,733
这个纵的这应该返回11吗 对吧

30
00:00:58,033 --> 00:00:58,733
那这时候

31
00:00:58,733 --> 00:01:01,366
你怎么用HLOOKUP或者XLOOKUP或那个呢?

32
00:01:01,366 --> 00:01:02,866
就很麻烦吗是不是

33
00:01:03,100 --> 00:01:03,933
那这时候我们就是

34
00:01:03,933 --> 00:01:05,933
其实可以用这两个 Function 来完成

35
00:01:05,933 --> 00:01:07,766
那首先我讲一下这个index啊

36
00:01:07,866 --> 00:01:10,233
这index实际上它是 索引

37
00:01:10,233 --> 00:01:12,066
它实际上是说给定一个

38
00:01:12,166 --> 00:01:12,766
区域

39
00:01:12,766 --> 00:01:15,366
然后你给呃第一个参数是一个区域

40
00:01:15,733 --> 00:01:18,000
呃或者数组或者区域啊或者表格

41
00:01:18,000 --> 00:01:21,200
然后第二个参数是它的行数

42
00:01:21,200 --> 00:01:23,500
第三个参数可以省略，是个列数

43
00:01:23,533 --> 00:01:24,833
我举个这么简单例子啊

44
00:01:24,833 --> 00:01:26,800
就是比如说index我

45
00:01:26,933 --> 00:01:29,366
这个吧 就这样选一下对吧

46
00:01:29,400 --> 00:01:32,933
它是一个呃列 列嘛 有个数组 对吧

47
00:01:32,966 --> 00:01:34,233
那如果返回

48
00:01:34,366 --> 00:01:37,933
这时候我要返回 Tom 就是第2行对吧

49
00:01:37,966 --> 00:01:40,566
这是第一行第2行是吧那就这么简单

50
00:01:40,600 --> 00:01:42,500
它实际上它就是应该返回 Tom

51
00:01:42,500 --> 00:01:45,166
这个数组的这个第2行对吧

52
00:01:45,166 --> 00:01:48,100
第二行或者那如果我可以多一点啊

53
00:01:48,100 --> 00:01:50,366
全选啊第一个表格呃

54
00:01:50,366 --> 00:01:52,033
是不是这整个表格

55
00:01:52,233 --> 00:01:54,366
那我说第2行第3列

56
00:01:55,300 --> 00:01:57,733
是吧 那是第2行1-2吗

57
00:01:57,733 --> 00:02:01,100
那是从1开始嘛, 一二第三列1-2-3对吧

58
00:02:01,100 --> 00:02:02,733
因为它返回应该是6嘛

59
00:02:03,233 --> 00:02:04,033
是不是

60
00:02:04,166 --> 00:02:06,100
那这个还说你会不会觉得就是很

61
00:02:06,466 --> 00:02:07,633
很无聊是吧

62
00:02:07,633 --> 00:02:09,933
我明明可以去直接去取

63
00:02:09,933 --> 00:02:10,933
C3是吧

64
00:02:11,200 --> 00:02:12,766
那为什么要这么麻烦呢?

65
00:02:12,933 --> 00:02:14,333
那这里面也有个讲究啊

66
00:02:14,333 --> 00:02:15,833
这个3你是写死的是吧

67
00:02:16,100 --> 00:02:17,800
你不能是变的吗 对吧

68
00:02:17,833 --> 00:02:18,666
它是一个常量

69
00:02:18,666 --> 00:02:20,266
它实际上它这个东西是reference

70
00:02:20,266 --> 00:02:21,833
它是确定的

71
00:02:21,833 --> 00:02:23,700
我如果通过刚才那种方式的话

72
00:02:23,700 --> 00:02:24,566
我这个index

73
00:02:24,700 --> 00:02:26,333
通过这个index然后

74
00:02:26,333 --> 00:02:28,566
A2:E7 那我这个行和这个

75
00:02:28,566 --> 00:02:31,266
呃这后面两个值都是可以是变的吗

76
00:02:31,300 --> 00:02:32,633
你是可以指定

77
00:02:32,833 --> 00:02:33,933
它的那个

78
00:02:34,100 --> 00:02:36,300
值是来自于哪一个格子 对不对

79
00:02:36,300 --> 00:02:38,066
它就是可以变的对吧

80
00:02:38,233 --> 00:02:39,533
是不是 这是INDEX

81
00:02:39,766 --> 00:02:41,100
那index还有一个比较有意思的

82
00:02:41,500 --> 00:02:42,633
它有两种形式

83
00:02:42,633 --> 00:02:44,966
刚才那个是说第一呃这个index

84
00:02:45,500 --> 00:02:46,933
呃我可以指定一个array

85
00:02:46,933 --> 00:02:48,933
但实际上它是可以指定多个array的

86
00:02:48,933 --> 00:02:50,700
那多个array你可以再加一个括号

87
00:02:50,700 --> 00:02:51,633
比如说我这样

88
00:02:52,033 --> 00:02:54,600
对吧 这个第一个区域是吧

89
00:02:54,766 --> 00:02:55,800
然后一个逗号

90
00:02:55,800 --> 00:02:57,600
那我再写第2个区域

91
00:02:57,833 --> 00:02:59,200
是吧 你可以多个区域

92
00:02:59,200 --> 00:03:00,666
那这时候我比如说 row number

93
00:03:00,666 --> 00:03:03,866
我比如说是第2行的第2列, 好吧

94
00:03:04,633 --> 00:03:06,066
那默认的话

95
00:03:06,066 --> 00:03:07,566
它应该是返回第一个区域的6

96
00:03:07,566 --> 00:03:09,700
但是你说我要返回第二个区域呢

97
00:03:09,700 --> 00:03:10,566
这就是第一个区域

98
00:03:10,566 --> 00:03:11,500
这个第二个区域

99
00:03:11,633 --> 00:03:14,300
我如果是一的话它应该是6返回6对吧

100
00:03:14,400 --> 00:03:16,633
如果把最后一个参数可选了啊

101
00:03:16,633 --> 00:03:18,500
就返呃第二个区域就是

102
00:03:19,000 --> 00:03:20,366
它就应该是返回16

103
00:03:20,566 --> 00:03:21,900
对吧 明白了啊

104
00:03:21,900 --> 00:03:23,966
这个是这个index的第二种格式

105
00:03:23,966 --> 00:03:25,500
然后这个是index

106
00:03:25,500 --> 00:03:26,900
就是说给定一个区域啊

107
00:03:26,900 --> 00:03:28,300
总的来说就是给定一个区域

108
00:03:28,300 --> 00:03:29,933
给定一个行数

109
00:03:29,933 --> 00:03:31,700
给定一个那个列数

110
00:03:31,700 --> 00:03:33,866
我就能返回它的那个值

111
00:03:34,066 --> 00:03:36,666
那就有点像我们从编程序里面 Python

112
00:03:36,666 --> 00:03:37,866
Python 里面的二维数组

113
00:03:38,066 --> 00:03:39,333
对一维数组或二维数组

114
00:03:39,333 --> 00:03:41,133
都可以给定一个数组下标

115
00:03:41,433 --> 00:03:44,233
对吧 实际上就是相当于array这个[row]

116
00:03:44,700 --> 00:03:45,433
[col] 是吧

117
00:03:45,433 --> 00:03:46,900
其实就是干这个事情

118
00:03:46,900 --> 00:03:48,500
Index 就是干这个事情而已

119
00:03:48,600 --> 00:03:49,600
那这个是Index函数

120
00:03:49,700 --> 00:03:51,333
第二函数是叫做match

121
00:03:52,033 --> 00:03:53,466
match就匹配 对吧

122
00:03:53,466 --> 00:03:55,233
匹配一样哈

123
00:03:55,233 --> 00:03:56,433
就是说我的match它

124
00:03:56,433 --> 00:03:57,433
它也是有几个参数

125
00:03:57,433 --> 00:03:58,433
第一个是 Lookup Value

126
00:03:58,433 --> 00:04:00,133
我要找的那个值 对不对

127
00:04:00,666 --> 00:04:01,466
我要找的那个值

128
00:04:01,466 --> 00:04:05,033
比如说我要找找这个Eric吧

129
00:04:05,033 --> 00:04:06,133
然后就找Eric

130
00:04:06,133 --> 00:04:07,766
然后在这里面找 对吧嗯

131
00:04:07,866 --> 00:04:09,100
那我要第二个参数

132
00:04:09,100 --> 00:04:10,900
就是它要找的数组 是吧

133
00:04:10,900 --> 00:04:11,900
我就这么找是吧

134
00:04:11,900 --> 00:04:14,800
这个 是不是跟之前的那个 XLOOKUP 有点像?

135
00:04:14,933 --> 00:04:16,266
match type还有三种值

136
00:04:16,266 --> 00:04:18,166
一个是1一个0一个-1

137
00:04:18,400 --> 00:04:20,500
那这个默认比较奇怪

138
00:04:20,500 --> 00:04:21,533
它默认不是0啊

139
00:04:21,533 --> 00:04:23,500
0是那个完全匹配啊

140
00:04:23,566 --> 00:04:26,366
那默认是1, 1就是

141
00:04:26,466 --> 00:04:28,033
找一个最大的

142
00:04:28,033 --> 00:04:29,300
就小于这个

143
00:04:29,433 --> 00:04:32,033
小于这个 Lookup 的值的最大的那个值

144
00:04:32,366 --> 00:04:33,100
有点绕口啊

145
00:04:33,100 --> 00:04:34,733
就是比如说你找不到的话

146
00:04:34,733 --> 00:04:36,500
比如说你要找呃

147
00:04:36,500 --> 00:04:38,066
99对吧

148
00:04:38,900 --> 00:04:39,733
找一个99

149
00:04:39,733 --> 00:04:41,833
但是你表里面没有99

150
00:04:41,900 --> 00:04:43,133
你有个98

151
00:04:43,133 --> 00:04:44,666
那这个98就是匹配

152
00:04:45,100 --> 00:04:47,533
那如果是-1的话就是比它大

153
00:04:47,533 --> 00:04:50,266
那就是如果你找99你没有99

154
00:04:50,266 --> 00:04:51,300
你有一个100

155
00:04:51,366 --> 00:04:52,733
那你返回100

156
00:04:53,366 --> 00:04:56,233
返回100的那个值的那个就是匹配吗

157
00:04:56,233 --> 00:04:57,866
就是等相当于100就匹配它了

158
00:04:57,866 --> 00:05:00,033
就是大于它的最小的那个数

159
00:05:00,066 --> 00:05:02,933
一是小于它的最大的那个数

160
00:05:02,933 --> 00:05:03,833
0就完全匹配

161
00:05:03,833 --> 00:05:05,666
就是必须要是99才可以

162
00:05:05,866 --> 00:05:06,366
对吧

163
00:05:06,366 --> 00:05:09,066
那这时候它返回是什么 它是返回第几

164
00:05:09,400 --> 00:05:10,766
在它的相对位置

165
00:05:10,833 --> 00:05:11,366
那你看吧

166
00:05:11,366 --> 00:05:14,400
这个eric在这个里面的相对位置是123

167
00:05:14,400 --> 00:05:14,933
第3个吧

168
00:05:14,933 --> 00:05:16,966
对吧 所以它就应该返回3

169
00:05:17,033 --> 00:05:19,600
明白吧 match就是三个参数

170
00:05:19,600 --> 00:05:21,566
第一个参数是你要找的那个值

171
00:05:22,200 --> 00:05:24,400
然后 第2个参数是你要找的那个值

172
00:05:24,400 --> 00:05:25,733
所在的那个

173
00:05:25,933 --> 00:05:27,566
那个列表 对吧

174
00:05:27,566 --> 00:05:29,466
就那个数组 可以这么理解

175
00:05:29,933 --> 00:05:33,400
然后 第三个是0 就是 0就 绝对匹配

176
00:05:33,400 --> 00:05:35,633
就是要完全一样才可以

177
00:05:36,066 --> 00:05:39,000
然后这时候它就返回它这个值

178
00:05:39,166 --> 00:05:42,166
第一个值在第二个数组里面的

179
00:05:42,266 --> 00:05:42,966
相对位置

180
00:05:42,966 --> 00:05:44,933
那是从1开始

181
00:05:45,000 --> 00:05:46,600
EXCEL里面都是从1开始啊

182
00:05:46,600 --> 00:05:48,266
就数组啊什么都是从1开始

183
00:05:48,266 --> 00:05:49,000
第1行第一列

184
00:05:49,000 --> 00:05:49,866
都是一啊

185
00:05:49,866 --> 00:05:52,100
不像编程里面它是0开始吗 对吧

186
00:05:52,100 --> 00:05:54,700
这里面还有一个问题就是说 它是

187
00:05:54,833 --> 00:05:56,000
就是大小写是

188
00:05:56,233 --> 00:05:57,600
就不太一样也可以啊

189
00:05:57,600 --> 00:05:58,733
这个是3嘛

190
00:05:58,833 --> 00:06:00,400
如果我改成小写的 eric

191
00:06:00,633 --> 00:06:01,266
它还是3

192
00:06:01,266 --> 00:06:01,700
就是它

193
00:06:01,700 --> 00:06:03,900
不一定是说完全要跟它一模一样啊

194
00:06:03,933 --> 00:06:06,100
如果完全要一样就得用另外一个函数

195
00:06:06,100 --> 00:06:08,666
叫 Exact 我们今天就不展开了

196
00:06:08,666 --> 00:06:10,900
这个比较复杂 EXACT 这个函数啊

197
00:06:11,300 --> 00:06:13,233
有兴趣可以自己去搜索一下

198
00:06:13,233 --> 00:06:14,300
这两个函数怎么

199
00:06:14,300 --> 00:06:15,333
怎么利用起来呢？

200
00:06:15,500 --> 00:06:16,066
对吧

201
00:06:16,066 --> 00:06:18,500
我是不是可以这么做吗 我这Eric是吧

202
00:06:18,533 --> 00:06:21,500
我首先Eric去找一下它是第几行

203
00:06:21,766 --> 00:06:23,400
对吧 第4行

204
00:06:23,600 --> 00:06:24,800
然后我这个

205
00:06:24,933 --> 00:06:25,600
这个 Month

206
00:06:25,600 --> 00:06:27,966
我也可以用这个横着去找它是第几列

207
00:06:28,533 --> 00:06:31,366
那我再用那个index对吧 去给它

208
00:06:31,366 --> 00:06:32,700
取那个值 不就完了嘛

209
00:06:32,733 --> 00:06:34,000
那我们试一下啊

210
00:06:34,266 --> 00:06:36,466
对吧你看啊 我首先这个外面是 Index

211
00:06:36,466 --> 00:06:37,866
我要取 我要取什么呢?

212
00:06:37,866 --> 00:06:39,666
我是不是要取这个表

213
00:06:39,800 --> 00:06:41,200
这个是要你要取的表 是吧

214
00:06:41,300 --> 00:06:44,233
那下一个是你要第几行 对吧?

215
00:06:44,266 --> 00:06:46,400
第几行是不是 我要去用MATCH去找?

216
00:06:47,033 --> 00:06:49,266
MATCH 第几行是名字 是吧

217
00:06:49,266 --> 00:06:51,900
那名字我是不是要找这个Eric的名字

218
00:06:52,433 --> 00:06:53,400
那在哪里找呢?

219
00:06:53,400 --> 00:06:54,600
是不是在这里面找

220
00:06:55,166 --> 00:06:56,700
它返回是不是第几行了 是吧

221
00:06:56,700 --> 00:06:59,566
那我0是说表示完全匹配 是吧

222
00:06:59,766 --> 00:07:02,166
然后那这时候是列吗 对吧

223
00:07:02,200 --> 00:07:03,700
列我是不是也是要match

224
00:07:03,900 --> 00:07:04,466
match什么呢

225
00:07:04,466 --> 00:07:07,166
我要找这个Month 是不是这里有 Month

226
00:07:07,466 --> 00:07:09,200
那它的列

227
00:07:09,200 --> 00:07:11,100
那个是不是月份

228
00:07:11,100 --> 00:07:13,400
月份是不是应该是这个在这里面找

229
00:07:13,466 --> 00:07:15,200
在这里面找这个值是吧

230
00:07:15,233 --> 00:07:17,666
那它返回的就是它的第几列 对不对

231
00:07:17,833 --> 00:07:19,533
然后这样就可以了

232
00:07:20,433 --> 00:07:22,700
你看啊 Eric March是不是11 对吧

233
00:07:22,800 --> 00:07:25,333
那我换一下啊 比如说我换一个 Mike

234
00:07:26,033 --> 00:07:28,133
Mike - March 应该是多少

235
00:07:28,700 --> 00:07:31,600
19是吧 那 Mike 的

236
00:07:32,333 --> 00:07:33,666
January 是不是

237
00:07:34,033 --> 00:07:35,500
Mike - January 是啥

238
00:07:35,766 --> 00:07:37,233
哎这里面有问题啊 是吧

239
00:07:37,400 --> 00:07:41,133
应该17 哎那这时候有问题 为什么?

240
00:07:41,200 --> 00:07:43,166
看一下 是不是 Mike

241
00:07:43,633 --> 00:07:46,533
January 应该是17 它为什么是18呢?

242
00:07:46,533 --> 00:07:50,366
B2:E7 没错啊 MATCH A11

243
00:07:50,466 --> 00:07:52,133
哦对 这里面少了一个后面(的参数)

244
00:07:52,300 --> 00:07:54,000
你看这个MATCH后面少了一个0

245
00:07:54,000 --> 00:07:54,800
我刚才说

246
00:07:54,800 --> 00:07:56,833
默认的话是 less than

247
00:07:56,933 --> 00:07:59,333
它不是 Exact Match 所以我要 Exact Match

248
00:07:59,533 --> 00:08:00,333
对吧它就17

249
00:08:00,333 --> 00:08:02,166
你看 我们这个找着问题

250
00:08:02,166 --> 00:08:03,133
还好找到了啊

251
00:08:03,133 --> 00:08:05,133
要不然就抓瞎了 对不对

252
00:08:05,966 --> 00:08:07,633
行啊今天我们就讲这个吧

253
00:08:07,633 --> 00:08:09,766
就是index加match就是怎么说呢

254
00:08:09,766 --> 00:08:11,200
就是这个 VLOOKUP 虽然好用

255
00:08:11,200 --> 00:08:12,800
但是它有一定的局限性啊

256
00:08:12,800 --> 00:08:14,766
就是它只能返回第一行第一列

257
00:08:14,766 --> 00:08:16,966
你要返回其它行 其它列 你就很麻烦了

258
00:08:17,200 --> 00:08:18,300
对吧 所以呃

259
00:08:18,300 --> 00:08:20,800
很经常 就是都用这个index和match

260
00:08:20,800 --> 00:08:23,500
就可以完成 比较相对来说 比较灵活

261
00:08:23,500 --> 00:08:24,766
比较复杂的这个

262
00:08:24,933 --> 00:08:27,166
检索啊 你可能单纯的去看

263
00:08:27,200 --> 00:08:29,333
这个index函数和这个match函数

264
00:08:29,333 --> 00:08:30,033
可能没什么用

265
00:08:30,033 --> 00:08:32,800
但是你可以那个结合起来啊

266
00:08:32,800 --> 00:08:33,633
功能比较强大了

267
00:08:33,666 --> 00:08:34,733
那我们今天回顾一下

268
00:08:34,733 --> 00:08:35,933
就是讲的这个index和match

269
00:08:36,000 --> 00:08:38,033
index是找

270
00:08:38,033 --> 00:08:39,933
数组的这个 就相当于这个吧

271
00:08:39,933 --> 00:08:42,400
对吧 是不是 那它有一个变种

272
00:08:42,400 --> 00:08:44,333
就是你可以指定多个区域

273
00:08:44,333 --> 00:08:46,500
多个区域 然后呃

274
00:08:46,500 --> 00:08:49,366
多个区域 实际上它就是相当于

275
00:08:49,566 --> 00:08:50,433
三维数组了

276
00:08:50,433 --> 00:08:52,033
多个区域就是那个最后面

277
00:08:52,033 --> 00:08:54,166
你记得那个最后面那个参数1, 2吗

278
00:08:54,166 --> 00:08:55,000
对吧 第一个区域 第二

279
00:08:55,000 --> 00:08:55,800
第二个区域

280
00:08:55,800 --> 00:08:56,966
它实际上就是

281
00:08:56,966 --> 00:09:00,833
就是 [area][row][col] 三维数组啊

282
00:09:00,933 --> 00:09:01,733
然后 这个 MATCH

283
00:09:01,733 --> 00:09:04,166
实际上就是相当于我要找的这个位置

284
00:09:04,233 --> 00:09:05,066
Lookup Value

285
00:09:05,866 --> 00:09:07,833
Lookup Value, 然后你要找到这个 Array

286
00:09:07,933 --> 00:09:10,433
然后 第三个参数0表示 Exact Match (完全匹配)

287
00:09:10,433 --> 00:09:11,400
就是完全匹配

288
00:09:11,400 --> 00:09:13,033
返回它的这个(匹配的)索引

289
00:09:13,066 --> 00:09:14,233
就是从1开始

290
00:09:14,300 --> 00:09:15,200
那这两个一结合

291
00:09:15,200 --> 00:09:16,000
就可以

292
00:09:16,033 --> 00:09:19,066
去完成这个 VLOOKUP 和 HLOOKUP 这样子的功能

293
00:09:19,400 --> 00:09:20,700
对吧 嗯

294
00:09:21,033 --> 00:09:21,900
有什么问题吗?

295
00:09:21,900 --> 00:09:22,833
没有, 好

296
00:09:22,833 --> 00:09:23,700
嗯今天就这样

297
00:09:23,700 --> 00:09:24,766
拜拜 拜拜

